
c*******************************************************
c... open files for recording grid generated by vegas and 
c... for recording the intermediate running information
c... e.g. (.grid)---> for grid; (.cs)---> for cross-section.
c*******************************************************

      subroutine upopenfile(imix,imixtype,ibcstate,ioctet)
      implicit none
	integer imix,imixtype,ibcstate,ioctet

c**************************************************
c...output files to store the running information for the integrated
c...cross-section. note here the p-wave states are only for gluon-
c...gluon fusion subprocess.

	if(imix.eq.1) then
c	 open(unit=3,file='data/mix.cs',status='unknown')
	 open(unit=3,file='mix.cs',status='unknown')
	end if

c--------------------------------------------
c...file about the generated grade by vegas.
	if(imix.eq.1) then
	 if(imixtype.eq.1) then
c	  open(unit=36,file='data/grade1s0.grid',status='unknown')
c	  open(unit=37,file='data/grade3s1.grid',status='unknown')
c	  open(unit=38,file='data/grade1p1.grid',status='unknown')
c	  open(unit=39,file='data/grade3p0.grid',status='unknown')
c	  open(unit=46,file='data/grade3p1.grid',status='unknown')
c	  open(unit=47,file='data/grade3p2.grid',status='unknown')
c	  open(unit=48,file='data/grade81s.grid',status='unknown')
c	  open(unit=49,file='data/grade83s.grid',status='unknown')
	  open(unit=36,file='grade1s0.grid',status='unknown')
	  open(unit=37,file='grade3s1.grid',status='unknown')
	  open(unit=38,file='grade1p1.grid',status='unknown')
	  open(unit=39,file='grade3p0.grid',status='unknown')
	  open(unit=46,file='grade3p1.grid',status='unknown')
	  open(unit=47,file='grade3p2.grid',status='unknown')
	  open(unit=48,file='grade81s.grid',status='unknown')
	  open(unit=49,file='grade83s.grid',status='unknown')
	 end if
	 if(imixtype.eq.2) then
c	  open(unit=36,file='data/grade1s0.grid',status='unknown')
c	  open(unit=37,file='data/grade3s1.grid',status='unknown')
	  open(unit=36,file='grade1s0.grid',status='unknown')
	  open(unit=37,file='grade3s1.grid',status='unknown')
	 end if
	 if(imixtype.eq.3) then
c	  open(unit=38,file='data/grade1p1.grid',status='unknown')
c	  open(unit=39,file='data/grade3p0.grid',status='unknown')
c	  open(unit=46,file='data/grade3p1.grid',status='unknown')
c	  open(unit=47,file='data/grade3p2.grid',status='unknown')
c	  open(unit=48,file='data/grade81s.grid',status='unknown')
c	  open(unit=49,file='data/grade83s.grid',status='unknown')
	  open(unit=38,file='grade1p1.grid',status='unknown')
	  open(unit=39,file='grade3p0.grid',status='unknown')
	  open(unit=46,file='grade3p1.grid',status='unknown')
	  open(unit=47,file='grade3p2.grid',status='unknown')
	  open(unit=48,file='grade81s.grid',status='unknown')
	  open(unit=49,file='grade83s.grid',status='unknown')
	 end if
	end if

c******************************************************
c...output files to store the running information for the integrated 
c...cross-section. note here the p-wave states are only for gluon-
c...gluon fusion subprocess.

      if(imix.eq.0) then
	 if(ibcstate.eq.1.and.ioctet.eq.0) then
c	    open(unit=3,file='data/1s0.cs',status='unknown')
c            open(unit=11,file='data/grade1s0.grid',status='unknown')
	    open(unit=3,file='1s0.cs',status='unknown')
            open(unit=11,file='grade1s0.grid',status='unknown')
         end if
	 if(ibcstate.eq.2.and.ioctet.eq.0) then
c     	    open(unit=3,file='data/3s1.cs',status='unknown')
c            open(unit=11,file='data/grade3s1.grid',status='unknown')
     	    open(unit=3,file='3s1.cs',status='unknown')
            open(unit=11,file='grade3s1.grid',status='unknown')
         end if
         if(ibcstate.eq.1.and.ioctet.eq.1) then
c           open(unit=3,file='data/oct1s0.cs',status='unknown')
c           open(unit=11,file='data/grade81s.grid',status='unknown')
           open(unit=3,file='oct1s0.cs',status='unknown')
           open(unit=11,file='grade81s.grid',status='unknown')
         end if
         if(ibcstate.eq.2.and.ioctet.eq.1) then
c           open(unit=3,file='data/oct3s1.cs',status='unknown')
c           open(unit=11,file='data/grade83s.grid',status='unknown')
           open(unit=3,file='oct3s1.cs',status='unknown')
           open(unit=11,file='grade83s.grid',status='unknown')
         end if
	 if(ibcstate.eq.3) then
c           open(unit=3,file='data/1p1.cs',status='unknown')
c           open(unit=11,file='data/grade1p1.grid',status='unknown')
           open(unit=3,file='1p1.cs',status='unknown')
           open(unit=11,file='grade1p1.grid',status='unknown')
         end if
	 if(ibcstate.eq.4) then
c     	   open(unit=3,file='data/3p0.cs',status='unknown')
c           open(unit=11,file='data/grade3p0.grid',status='unknown')
     	   open(unit=3,file='3p0.cs',status='unknown')
           open(unit=11,file='grade3p0.grid',status='unknown')
         end if
	 if(ibcstate.eq.5) then
c     	   open(unit=3,file='data/3p1.cs',status='unknown')
c           open(unit=11,file='data/grade3p1.grid',status='unknown')
     	   open(unit=3,file='3p1.cs',status='unknown')
           open(unit=11,file='grade3p1.grid',status='unknown')
         end if
	 if(ibcstate.eq.6) then
c     	   open(unit=3,file='data/3p2.cs',status='unknown')
c           open(unit=11,file='data/grade3p2.grid',status='unknown')
     	   open(unit=3,file='3p2.cs',status='unknown')
           open(unit=11,file='grade3p2.grid',status='unknown')
         end if
      end if

	end

CREATE TABLE RRES_AUX_0 AS SELECT DISTINCT RUNID, LABEL FROM TEST_STATUS ORDER BY RUNID, LABEL;
CREATE TABLE RRES_AUX_1 AS SELECT ROWNUM RID, RUNID, LABEL FROM RRES_AUX_0 ORDER BY RID;
CREATE TABLE RUN_RESULT_TMP AS SELECT T0.ID, T0.RUNID, T0.RDATE, T0.LABEL, T0.T_RELEASE, T0.T_ARCH, T0.R_RELEASE, T0.R_ARCH, T0.LOG, T1.RID  FROM TEST_STATUS T0, RRES_AUX_1 T1 WHERE T0.RUNID=T1.RUNID AND T0.LABEL=T1.LABEL ORDER BY T1.RID;
CREATE TABLE RUN_RESULT AS SELECT ROWNUM E_ID, ID, RUNID, RDATE, LABEL, T_RELEASE, T_ARCH, R_RELEASE, R_ARCH, LOG, RID  FROM  RUN_RESULT_TMP ORDER BY RID;
DROP TABLE RUN_RESULT_TMP;
CREATE TABLE RUN_STEP_RESULT AS SELECT T1.E_ID, T0.NAME STEP_LABEL, T0.STATUS FROM TEST_RESULTS T0, RUN_RESULT T1 WHERE T0.ID=T1.ID AND T0.LABEL=T1.LABEL;
ALTER TABLE RUN_RESULT DROP COLUMN ID;
ALTER TABLE RUN_RESULT RENAME COLUMN E_ID TO ID;
ALTER TABLE RUN_STEP_RESULT RENAME COLUMN E_ID TO ID;
CREATE TABLE RRES_AUX_2 AS SELECT MIN(ID) ID FROM RUN_RESULT GROUP BY RID;
CREATE TABLE RUN_HEADER AS SELECT T0.RID, T0.RDATE, T0.LABEL, T0.T_RELEASE, T0.T_ARCH, T0.LOG FROM RUN_RESULT T0, RRES_AUX_2 T1 WHERE T0.ID=T1.ID; 
ALTER TABLE RUN_RESULT DROP COLUMN RDATE;
ALTER TABLE RUN_RESULT DROP COLUMN LABEL;
ALTER TABLE RUN_RESULT DROP COLUMN T_RELEASE;
ALTER TABLE RUN_RESULT DROP COLUMN T_ARCH;
ALTER TABLE RUN_RESULT DROP COLUMN LOG;
DROP TABLE RRES_AUX_0;
DROP TABLE RRES_AUX_1;
DROP TABLE RRES_AUX_2;
DROP SEQUENCE RUN_ID_SEQ;
DROP SEQUENCE RES_ID_SEQ;